<div style="visibility: hidden; position: fixed"
     [style.left]="menuTopLeftPosition.x"
     [style.top]="menuTopLeftPosition.y"
     [matMenuTriggerFor]="rightMenu">
</div>

<mat-menu #rightMenu="matMenu">
  <div (click) = "$event.stopPropagation()">
    <ng-template matMenuContent>
      <button mat-menu-item (click)="untapAll()">Untap All</button>
      <div *ngIf="rightclicked_item.type && rightclicked_item.type === 'deck'">
        <div>
          <button mat-button (click)="drawCard(current_draw)">Draw</button>
          <input matInput type="number" style="width: 40px; margin: 2px; background: rgba(0,0,0,0); border: none; color: white" [(ngModel)]="current_draw">
        </div>
        <div>
          <button mat-button (click)="openSideNav('scry')">Scry</button>
          <input matInput type="number" style="width: 40px; margin: 2px; background: rgba(0,0,0,0); border: none; color: white" [(ngModel)]="current_draw">
        </div>
        <div>
          <button mat-button (click)="drawToZone(current_drawto, 'play')">Draw to Play</button>
          <input matInput type="number" style="width: 40px; margin: 2px; background: rgba(0,0,0,0); border: none; color: white" [(ngModel)]="current_drawto">
        </div>
        <div>
          <button mat-button (click)="drawToZone(current_drawto, 'grave')">Draw to Grave</button>
          <input matInput type="number" style="width: 40px; margin: 2px; background: rgba(0,0,0,0); border: none; color: white" [(ngModel)]="current_drawto">
        </div>
        <div>
          <button mat-button (click)="drawToZone(current_drawto, 'exile')">Draw to Exile</button>
          <input matInput type="number" style="width: 40px; margin: 2px; background: rgba(0,0,0,0); border: none; color: white" [(ngModel)]="current_drawto">
        </div>
        <div>
          <button mat-button (click)="drawToZone(current_drawto, 'temp_zone')">Draw to Temp</button>
          <input matInput type="number" style="width: 40px; margin: 2px; background: rgba(0,0,0,0); border: none; color: white" [(ngModel)]="current_drawto">
        </div>
        <div>
          <button mat-button (click)="drawToOtherTempZone(current_drawto, selected_player)">Send to Selected</button>
          <input matInput type="number" style="width: 40px; margin: 2px; background: rgba(0,0,0,0); border: none; color: white" [(ngModel)]="current_drawto">
        </div>
        <button mat-menu-item (click)="openSideNav('deck')">Search Deck</button>
        <button mat-menu-item (click)="shuffleDeck(user.deck.cards)">Shuffle</button>
        <button mat-menu-item (click)="nextTurn()">Next Turn</button>
      </div>
      <div *ngIf="rightclicked_item.type && rightclicked_item.type === 'hand'">
        <button mat-menu-item (click)="sendToPlayWrapper(rightclicked_item.card, rightclicked_item.from)">Send to Play</button>
        <button mat-menu-item (click)="sendToGrave(rightclicked_item.card, rightclicked_item.from)">Send to Grave</button>
        <button mat-menu-item (click)="sendToExile(rightclicked_item.card, rightclicked_item.from)">Send to Exile</button>
        <button mat-menu-item (click)="sendToDeck(rightclicked_item.card, rightclicked_item.from, 0)">Send to Deck Top</button>
        <button mat-menu-item (click)="sendToDeck(rightclicked_item.card, rightclicked_item.from, -1)">Send to Deck Bottom</button>
        <button mat-menu-item (click)="sendToTempZone(rightclicked_item.card, rightclicked_item.from, user)">Send to Temp</button>
        <button mat-menu-item (click)="sendToTempZone(rightclicked_item.card, rightclicked_item.from, selected_player)">Send to Selected</button>
      </div>
      <div *ngIf="rightclicked_item.type && rightclicked_item.type === 'inPlayUser'">
        <button mat-menu-item (click)="tapSpot(rightclicked_item.spot)">(un)Tap Stack</button>
        <button mat-menu-item (click)="sendToHand(rightclicked_item.card, rightclicked_item.spot)">Send to Hand</button>
        <button mat-menu-item (click)="sendToGrave(rightclicked_item.card, rightclicked_item.spot)">Send to Grave</button>
        <button mat-menu-item (click)="sendToExile(rightclicked_item.card, rightclicked_item.spot)">Send to Exile</button>
        <button mat-menu-item (click)="sendToTempZone(rightclicked_item.card, rightclicked_item.spot, user)">Send to Temp</button>
        <button mat-menu-item (click)="sendToTempZone(rightclicked_item.card, rightclicked_item.spot, selected_player)">Send to Selected</button>
        <button mat-menu-item (click)="sendToDeck(rightclicked_item.card, rightclicked_item.spot, 0)">Send to Deck Top</button>
        <button mat-menu-item (click)="sendToDeck(rightclicked_item.card, rightclicked_item.spot, -1)">Send to Deck Bottom</button>
        <button mat-menu-item (click)="rightclicked_item.card.counter_1 = !rightclicked_item.card.counter_1; rightclicked_item.card.counter_1_value=0">Toggle Counter 1</button>
        <button mat-menu-item (click)="rightclicked_item.card.counter_2 = !rightclicked_item.card.counter_2; rightclicked_item.card.counter_2_value=0">Toggle Counter 2</button>
        <button mat-menu-item (click)="rightclicked_item.card.counter_3 = !rightclicked_item.card.counter_3; rightclicked_item.card.counter_3_value=0">Toggle Counter 3</button>
        <button mat-menu-item (click)="rightclicked_item.card.multiplier = !rightclicked_item.card.multiplier; rightclicked_item.card.multiplier_value=0">Toggle Multiplier</button>
      </div>
      <div *ngIf="rightclicked_item.type && rightclicked_item.type === 'grave'">
        <button mat-menu-item (click)="openSideNav('grave')">View Graveyards</button>
      </div>
      <div *ngIf="rightclicked_item.type && rightclicked_item.type === 'exile'">
        <button mat-menu-item (click)="openSideNav('exile')">View Exiles</button>
      </div>
      <div *ngIf="rightclicked_item.type && rightclicked_item.type === 'temp-zone'">
        <button mat-menu-item (click)="openSideNav('temp_zone')">View Temp Zones</button>
      </div>
      <div *ngIf="rightclicked_item.type && rightclicked_item.type === 'sidenav'">
        <button mat-menu-item (click)="sendToPlayWrapper(rightclicked_item.card, rightclicked_item.from)">Send to Play</button>
        <button mat-menu-item (click)="sendToGrave(rightclicked_item.card, rightclicked_item.from)">Send to Grave</button>
        <button mat-menu-item (click)="sendToExile(rightclicked_item.card, rightclicked_item.from)">Send to Exile</button>
        <button mat-menu-item (click)="sendToDeck(rightclicked_item.card, rightclicked_item.from, 0)">Send to Deck Top</button>
        <button mat-menu-item (click)="sendToDeck(rightclicked_item.card, rightclicked_item.from, -1)">Send to Deck Bottom</button>
        <button mat-menu-item (click)="sendToHand(rightclicked_item.card, rightclicked_item.from)">Send to Hand</button>
        <button mat-menu-item (click)="sendToTempZone(rightclicked_item.card, rightclicked_item.from, user)">Send to Temp</button>
        <button mat-menu-item (click)="sendToTempZone(rightclicked_item.card, rightclicked_item.from, selected_player)">Send to Selected</button>
      </div>
    </ng-template>
  </div>
</mat-menu>

<mat-sidenav-container fxFlexFill cdkDropListGroup hasBackdrop="false" *ngIf="!loading">
  <mat-sidenav #fddp_sidenav (keydown.escape)="fddp_sidenav.close()" disableClose>
    <mat-toolbar color="primary">
      <div fxFlex="100" fxLayout="row" fxLayoutAlign="space-between center">
        <h2 fxFlex *ngIf="sidenav_type==='grave'">Graveyards</h2>
        <h2 fxFlex *ngIf="sidenav_type==='exile'">Exile</h2>
        <h2 fxFlex *ngIf="sidenav_type==='temp_zone'">Temp Zones</h2>
        <h2 fxFlex *ngIf="sidenav_type==='deck'">Searching Deck</h2>
        <h2 fxFlex *ngIf="sidenav_type==='scry'">Scrying</h2>
        <button mat-icon-button (click)="closeSideNav()">
          <mat-icon>close</mat-icon>
        </button>
      </div>
    </mat-toolbar>
    <div *ngIf="sidenav_type === 'grave'">
      <div fxLayout="column">
        <mat-form-field appearance="outline" fxFlex style="margin: 5px;">
          <mat-label>Player</mat-label>
          <mat-select [(ngModel)]="sidenav_selected_player" name="player_select_sidenav" (ngModelChange)="updateSidenav()">
            <mat-option *ngFor="let player of players" [value]="player">
              {{player.name}}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field fxFlex style="margin: 5px;" appearance="outline">
          <mat-label>Search</mat-label>
          <input type="text" placeholder="Card Name"
                 matInput [matAutocomplete]="card_name"
                 [(ngModel)]="sidenav_sort" (ngModelChange)="getSidenavSort(sidenav_selected_player.grave)">
          <mat-autocomplete #card_name>
            <mat-option *ngFor="let card of sidenav_selected_player.grave" [value]="card.name">
              {{card.name}}
            </mat-option>
          </mat-autocomplete>
        </mat-form-field>
        <div class="sidenav-list" cdkDropList
             (cdkDropListDropped)="moveCardToGrave($event)"
             [cdkDropListData]="sidenav_selected_player.grave">
          <div *ngFor="let card of sidenav_selected_player.grave"
               class="sidenav-list-item"
               [ngClass]="{'sidenav-list-item-selected': card.selected}"
               (pointerenter)="hovered_card=card" (pointerleave)="hovered_card=null"
               (cdkDragStarted)="hovered_card=null"
               (click)="toggleCardSelect(card, sidenav_selected_player.grave, card.sidenav_visible)"
               [cdkDragDisabled]="!card.sidenav_visible" (contextmenu)="onRightClick($event, {type: 'sidenav', card: card, from: sidenav_selected_player.grave})"
               cdkDrag>
            {{card.name}}
            <img *cdkDragPreview [src]="card.image" [alt]="card.name" class="mtg-card-user">
            <img *cdkDragPlaceholder class="mtg-card-user" [src]="card.image" [alt]="card.name">
          </div>
        </div>
      </div>
    </div>
    <div *ngIf="sidenav_type === 'exile'">
      <div fxLayout="column">
        <mat-form-field appearance="outline" fxFlex style="margin: 5px;">
          <mat-label>Player</mat-label>
          <mat-select [(ngModel)]="sidenav_selected_player" name="player_select_sidenav" (ngModelChange)="updateSidenav()">
            <mat-option *ngFor="let player of players" [value]="player">
              {{player.name}}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field fxFlex style="margin: 5px;" appearance="outline">
          <mat-label>Search</mat-label>
          <input type="text" placeholder="Card Name"
                 matInput [matAutocomplete]="card_name"
                 [(ngModel)]="sidenav_sort" (ngModelChange)="getSidenavSort(sidenav_selected_player.exile)">
          <mat-autocomplete #card_name>
            <mat-option *ngFor="let card of sidenav_selected_player.exile" [value]="card.name">
              {{card.name}}
            </mat-option>
          </mat-autocomplete>
        </mat-form-field>
        <div class="sidenav-list" cdkDropList
             (cdkDropListDropped)="moveCardToExile($event)"
             [cdkDropListData]="sidenav_selected_player.exile">
          <div *ngFor="let card of sidenav_selected_player.exile"
               class="sidenav-list-item"
               [ngClass]="{'sidenav-list-item-selected': card.selected}"
               (pointerenter)="hovered_card=card" (pointerleave)="hovered_card=null"
               (cdkDragStarted)="hovered_card=null"
               (click)="toggleCardSelect(card, sidenav_selected_player.exile, card.sidenav_visible)"
               (contextmenu)="onRightClick($event, {type: 'hand', card: card, from: sidenav_selected_player.exile})"
               [cdkDragDisabled]="!card.sidenav_visible"
               cdkDrag>
            {{card.name}}
            <img *cdkDragPreview [src]="card.image" [alt]="card.name" class="mtg-card-user">
            <img *cdkDragPlaceholder class="mtg-card-user" [src]="card.image" [alt]="card.name">
          </div>
        </div>
      </div>
    </div>
    <div *ngIf="sidenav_type === 'temp_zone'">
      <div fxLayout="column">
        <mat-form-field appearance="outline" fxFlex style="margin: 5px;">
          <mat-label>Player</mat-label>
          <mat-select [(ngModel)]="sidenav_selected_player" name="player_select_sidenav" (ngModelChange)="updateSidenav()">
            <mat-option *ngFor="let player of players" [value]="player">
              {{player.name}}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field fxFlex style="margin: 5px;" appearance="outline">
          <mat-label>Search</mat-label>
          <input type="text" placeholder="Card Name"
                 matInput [matAutocomplete]="card_name"
                 [(ngModel)]="sidenav_sort" (ngModelChange)="getSidenavSort(sidenav_selected_player.temp_zone)">
          <mat-autocomplete #card_name>
            <mat-option *ngFor="let card of sidenav_selected_player.temp_zone" [value]="card.name">
              {{card.name}}
            </mat-option>
          </mat-autocomplete>
        </mat-form-field>
        <div class="sidenav-list" cdkDropList
             (cdkDropListDropped)="moveCardToTempZone($event)"
             [cdkDropListData]="sidenav_selected_player.temp_zone">
          <div *ngFor="let card of sidenav_selected_player.temp_zone"
               class="sidenav-list-item"
               [ngClass]="{'sidenav-list-item-selected': card.selected}"
               (pointerenter)="hovered_card=card" (pointerleave)="hovered_card=null"
               (cdkDragStarted)="hovered_card=null"
               (click)="toggleCardSelect(card, sidenav_selected_player.temp_zone, card.sidenav_visible)"
               (contextmenu)="onRightClick($event, {type: 'hand', card: card, from: sidenav_selected_player.temp_zone})"
               [cdkDragDisabled]="!card.sidenav_visible"
               cdkDrag>
            {{card.name}}
            <img *cdkDragPreview [src]="card.image" [alt]="card.name" class="mtg-card-user">
            <img *cdkDragPlaceholder class="mtg-card-user" [src]="card.image" [alt]="card.name">
          </div>
        </div>
      </div>
    </div>
    <div *ngIf="sidenav_type === 'deck' || sidenav_type === 'scry'">
      <div fxLayout="column">
        <mat-form-field fxFlex style="margin: 5px;" appearance="outline">
          <mat-label>Search</mat-label>
          <input type="text" placeholder="Card Name"
                 matInput [matAutocomplete]="card_name"
                 [(ngModel)]="sidenav_sort" (ngModelChange)="getSidenavSort(sidenav_selected_player.deck.cards)">
          <mat-autocomplete #card_name>
            <mat-option *ngFor="let card of sidenav_selected_player.deck.cards" [value]="card.name">
              {{card.name}}
            </mat-option>
          </mat-autocomplete>
        </mat-form-field>
        <div class="sidenav-list" cdkDropList
             (cdkDropListDropped)="moveCardToDeck($event)"
             [cdkDropListData]="sidenav_selected_player.deck.cards">
          <div *ngFor="let card of sidenav_selected_player.deck.cards; let c = index">
            <div *ngIf="sidenav_type === 'deck' || (sidenav_type === 'scry' && c < sidenav_scry)" class="sidenav-list-item"
              [ngClass]="{'sidenav-list-item-selected': card.selected}"
              (pointerenter)="hovered_card=card" (pointerleave)="hovered_card=null"
              (cdkDragStarted)="hovered_card=null"
              (click)="toggleCardSelect(card, sidenav_selected_player.deck.cards, card.sidenav_visible)"
              (contextmenu)="onRightClick($event, {type: 'hand', card: card, from: sidenav_selected_player.deck.cards})"
              [cdkDragDisabled]="!card.sidenav_visible"
              cdkDrag>
              {{card.name}}
              <img *cdkDragPreview [src]="card.image" [alt]="card.name" class="mtg-card-user">
              <img *cdkDragPlaceholder class="mtg-card-user" [src]="card.image" [alt]="card.name">
            </div>
          </div>
        </div>
      </div>
    </div>
  </mat-sidenav>
  <mat-sidenav-content>
      <div class="card-preview" *ngIf="hovered_card">
        <mat-card fxLayout="row" fxLayoutAlign="start start" fxFlexFill>
          <div fxLayout="column" fxLayoutAlign="start center" fxFlex="100">
            <img class="mtg-card-preview" src="{{hovered_card.image}}" alt="{{hovered_card.name}}">
            <h3 style="text-align: center">{{hovered_card.name}}</h3>
            <h3 style="text-align: center">{{hovered_card.mana_cost}}</h3>
            <h3 style="margin: 10px; white-space: pre-line">{{hovered_card.oracle_text}}</h3>
          </div>
        </mat-card>
      </div>
      <div class="player-list">
        <mat-list>
          <mat-divider></mat-divider>
          <div *ngFor="let player of players; let j = index">
            <mat-list-item [ngClass]="{'player-button-selected': player.selected,
                                  'player-button-turn': player.turn == current_turn}">
              <div fxLayout="row" fxLayoutAlign="space-between center" fxFlexFill>
                <div fxLayout="column" fxFlex="100">
                  <button
                    class="player-button"
                    matTooltip="Hand: {{player.hand.length}} Deck: {{player.deck.cards.length}} Grave: {{player.grave.length}} Exile: {{player.exile.length}}"
                    matTooltipPosition="right"
                    matTooltipShowDelay="1000"
                    mat-button
                    (click)="selectPlayer(player)">
                    {{player.name}}
                  </button>
                </div>
                <div fxLayout="column" fxFlex="100">
                  <div fxLayout="row" fxFlex>
                    <div class="column" fxFlex>
                      <button *ngIf="isOpponent(player)" class="player-button" mat-button disabled style="color: white">
                        {{player.life}}
                      </button>
                      <button *ngIf="!isOpponent(player)" class="player-button" mat-button
                              (click)="player.life = player.life + 1" (contextmenu)="onRightClick($event, {type: 'life', player: player})">
                        {{player.life}}
                      </button>
                    </div>
                    <div class="column" fxFlex>
                      <button *ngIf="isOpponent(player)" class="player-button" mat-button disabled style="color: white">
                        {{player.infect}}
                      </button>
                      <button *ngIf="!isOpponent(player)" class="player-button" mat-button
                              (click)="player.infect = player.infect + 1" (contextmenu)="onRightClick($event, {type: 'infect', player: player})">
                        {{player.infect}}
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </mat-list-item>
            <mat-divider *ngIf="j != players.length - 1"></mat-divider>
          </div>
        </mat-list>
      </div>
      <div fxFlexFill (contextmenu)="onRightClick($event, {type: 'none'})">
        <div class="container" fxLayout="row" fxLayoutAlign="center end" fxFlexFill>
          <div fxLayout="column" fxLayoutAlign="start center" fxFlexFill style="margin: 10px;">
            <!-- Opponents -->
            <div class="opponent-holder" fxFlex="100" fxLayout="row" fxLayoutAlign="center center">
              <div class="opponent-playmat-holder" fxLayout="row wrap" fxLayout.lt-md="column" fxLayoutAlign="center">
                <div *ngFor="let player of players">
                  <div *ngIf="isOpponent(player)" class="playmat-opponent" [ngClass]="{'playmat-opponent-selected': player.selected}" fxLayout="row wrap" fxLayoutAlign="center center">
                    <div *ngFor="let spot of reverse(player.playmat)" class="mtg-card-holder-opponent">
                      <div *ngFor="let card of spot; let i = index">
                        <img
                          [ngClass]="
                {
                  'stack-1': i == 0,
                  'stack-2': i == 1,
                  'stack-3': i == 2
                }"
                          [@opponentTappedState]="card.tapped"
                          class="mtg-card-opponent mtg-card-opponent-play"
                          src="{{card.image}}"
                          alt="{{card.name}}"
                          (pointerenter)="hovered_card=card" (pointerleave)="hovered_card=null">
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- User Playmat -->
            <div fxLayout="row" fxFlex fxLayoutAlign="center">
              <div class="playmat-user" fxLayout="row wrap" fxLayoutAlign="start start">
                <div *ngFor="let spot of user.playmat"
                     class="mtg-card-holder-user"
                     cdkDropList
                     [cdkDropListData]="spot"
                     (cdkDropListDropped)="moveCardToPlay($event)">
                  <div *ngFor="let card of spot; let i = index">
                    <div [ngClass]="{'stack-1': i == 0, 'stack-2': i == 1, 'stack-3': i == 2}"
                         (pointerenter)="hovered_card=card" (pointerleave)="hovered_card=null"
                         (cdkDragStarted)="hovered_card=null"
                         class="mtg-card-user-container" [@userTappedState]="card.tapped"
                         cdkDrag>
                      <img [ngClass]="{'mtg-card-user-selected': card.selected }"
                           class="mtg-card-user"
                           src="{{card.image}}"
                           alt="{{card.name}}"
                           (contextmenu)="onRightClick($event,{type: 'inPlayUser', card: card, spot: spot})"
                           (click)="toggleCardSelect(card, spot)" (dblclick)="tapCard(card)">
                      <button *ngIf="card.counter_1" class="mtg-counter-1" mat-fab color="primary" [class.mat-elevation-z8]="true" (click)="card.counter_1_value = card.counter_1_value + 1" (contextmenu)="onRightClick($event, {type: 'counter_1', card: card})"><p>{{card.counter_1_value}}</p></button>
                      <button *ngIf="card.counter_2" class="mtg-counter-2" mat-fab color="accent" [class.mat-elevation-z8]="true" (click)="card.counter_2_value = card.counter_2_value + 1" (contextmenu)="onRightClick($event, {type: 'counter_2', card: card})"><p>{{card.counter_2_value}}</p></button>
                      <button *ngIf="card.counter_3" class="mtg-counter-3" mat-fab color="warn" [class.mat-elevation-z8]="true" (click)="card.counter_3_value = card.counter_3_value + 1" (contextmenu)="onRightClick($event, {type: 'counter_3', card: card})"><p>{{card.counter_3_value}}</p></button>
                      <button *ngIf="card.multiplier" class="mtg-multiplier-counter" mat-fab color="accent" [class.mat-elevation-z8]="true" (click)="card.multiplier_value = card.multiplier_value + 1" (contextmenu)="onRightClick($event, {type: 'multiplier', card: card})"><p>{{card.multiplier_value}}</p></button>
                      <h4 *ngIf="card.power && card.toughness" class="mtg-card-power-tough">{{card.power}}/{{card.toughness}}</h4>
                      <h4 *ngIf="card.loyalty" class="mtg-card-loyalty">{{card.loyalty}}</h4>
                    </div>

                  </div>
                </div>
              </div>
            </div>
            <!-- Opponent Hand -->
            <div fxLayout="row" fxFlex fxLayoutAlign="center">
              <div class="opponent-hand" fxLayout="column" fxLayoutAlign="center">
                <div *ngIf="selected_player != null" class="opponent-hand-list"
                     fxFlex fxLayout="row" fxLayoutAlign="start">
                  <h1 class="hand-count">{{selected_player.hand.length}}</h1>
                  <img *ngFor="let card of selected_player.hand" fxFlex fxLayout="column"
                       class="mtg-card-opponent"
                       src="{{card.image}}" alt="{{card.name}}"
                       (contextmenu)="onRightClick($event, {type: 'opponent_hand', card: card})"
                       (pointerenter)="hovered_card=card" (pointerleave)="hovered_card=null">
                </div>
              </div>
            </div>
            <!-- User Hand -->
            <div fxLayout="row" fxFlex fxLayoutAlign="center">
              <div class="user-hand" fxLayout="column" fxLayoutAlign="center">
                <div cdkDropList class="user-hand-list"
                     cdkDropListOrientation="horizontal"
                     [cdkDropListData]="user.hand"
                     (cdkDropListDropped)="moveCardToHand($event)" fxFlex fxLayout="row" fxLayoutAlign="start">
                  <h1 class="hand-count">{{user.hand.length}}</h1>
                  <div *ngFor="let card of user.hand" [ngClass]="{'mtg-card-user-container': card.selected}"
                       fxFlex fxLayout="column"
                       (contextmenu)="onRightClick($event, {type: 'hand', card: card, from: user.hand})"
                       (pointerenter)="hovered_card=card" (pointerleave)="hovered_card=null"
                       (click)="toggleCardSelect(card, user.hand)"
                       (cdkDragStarted)="hovered_card=null"
                       cdkDrag>
                    <img [ngClass]="{ 'mtg-card-user-selected': card.selected }" class="mtg-card-user" src="{{card.image}}" alt="{{card.name}}">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="user-deck">
          <div class="zone-data"
               (dblclick)="drawCard(1);"
               (contextmenu)="onRightClick($event, {type: 'deck'})"
               cdkDropList [cdkDropListData]="user.deck.cards"
               cdkDropListOrientation="horizontal"
               (cdkDropListDropped)="moveCardToDeck($event)">
            <h1 class="zone-count">{{user.deck.cards.length}}</h1>
            <img class="mtg-card-user"
                 src="https://c1.scryfall.com/file/scryfall-card-backs/large/59/597b79b3-7d77-4261-871a-60dd17403388.jpg?1561757129"
                 (pointerleave)="hovered_card=null"
                 (cdkDragStarted)="hovered_card=null"
                 cdkDrag>
          </div>
        </div>
        <div class="user-grave">
          <div class="zone-data"
               (contextmenu)="onRightClick($event, {type: 'grave'})"
               cdkDropList [cdkDropListData]="user.grave"
               cdkDropListOrientation="horizontal"
               (cdkDropListDropped)="moveCardToGrave($event)">
            <div class="zone-title"><h5>Graveyard</h5></div>
            <h1 class="zone-count">{{user.grave.length}}</h1>
            <div *ngIf="user.grave.length == 0" class="mtg-card-user"></div>
            <img *ngIf="user.grave.length > 0" class="mtg-card-user" src="{{user.grave[0].image}}"
                 (pointerleave)="hovered_card=null"
                 (cdkDragStarted)="hovered_card=null"
                 cdkDrag>
          </div>
        </div>
        <div class="user-exile">
          <div class="zone-data" (contextmenu)="onRightClick($event, {type: 'exile'})"
               cdkDropList [cdkDropListData]="user.exile"
               cdkDropListOrientation="horizontal"
               (cdkDropListDropped)="moveCardToExile($event)">
            <div class="zone-title"><h5>Exile</h5></div>
            <h1 class="zone-count">{{user.exile.length}}</h1>
            <div *ngIf="user.exile.length == 0" class="mtg-card-user"></div>
            <img *ngIf="user.exile.length > 0" class="mtg-card-user" src="{{user.exile[0].image}}"
                 (pointerleave)="hovered_card=null"
                 (cdkDragStarted)="hovered_card=null"
                 cdkDrag>
          </div>
        </div>
        <div class="user-temp-zone">
          <div class="zone-data" (contextmenu)="onRightClick($event, {type: 'temp-zone'})"
               cdkDropList [cdkDropListData]="user.temp_zone"
               cdkDropListOrientation="horizontal"
               (cdkDropListDropped)="moveCardToTempZone($event)">
            <div class="zone-title"><h5>Temp</h5></div>
            <h1 class="zone-count">{{user.temp_zone.length}}</h1>
            <div *ngIf="user.temp_zone.length == 0" class="mtg-card-user"></div>
            <img *ngIf="user.temp_zone.length > 0" class="mtg-card-user" src="{{user.temp_zone[0].image}}"
                 (pointerleave)="hovered_card=null"
                 (cdkDragStarted)="hovered_card=null"
                 cdkDrag>
          </div>
        </div>
        <div class="commander-viewer">
          <div *ngIf="user.deck.commander.length == 1">
            <img class="commander-viewer-single" src="{{user.deck.commander[0].image}}">
          </div>
          <div *ngIf="user.deck.commander.length == 2" class="commander-viewer-partner-holder">
            <img class="commander-viewer-partner-1" src="{{user.deck.commander[0].image}}">
            <img class="commander-viewer-partner-2" src="{{user.deck.commander[1].image}}">
          </div>
        </div>
        <div class="commander-dashboard">
          <div class="commander-dashboard-button-holder">

          </div>
        </div>
        <div class="selected-commander-viewer">
          <img *ngIf="selected_player"
               class="mtg-card-user"
               src="{{selected_player.deck.commander[0].image}}" alt="{{selected_player.deck.commander[0].name}}"
               (pointerenter)="hovered_card=selected_player.deck.commander[0]" (pointerleave)="hovered_card=null">
        </div>
        <div class="selected-player-data">

        </div>
      </div>
  </mat-sidenav-content>
</mat-sidenav-container>


